<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Zay Shop - Product Detail Page</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="apple-touch-icon" href="img/apple-icon.png" />
    <link rel="shortcut icon" type="image/x-icon" href="img/favicon.ico" />

    <link rel="stylesheet" href="../../../static/website/css/bootstrap.min.css" />
    <link rel="stylesheet" href="../../../static/website/css/templatemo.css" />
    <link rel="stylesheet" href="../../../static/website/../../../static/website/css/custom.css" />
    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&family=Playfair+Display:wght@700;900&display=swap"
      rel="stylesheet"
    />

    <!-- Icon Font Stylesheet -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css"
      rel="stylesheet"
    />

    <!-- Libraries Stylesheet -->
    <link href="../../../static/website/lib/animate/animate.min.css" rel="stylesheet" />
    <link href="../../../static/website/lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet" />

    <!-- Customized Bootstrap Stylesheet -->
    <!-- <link href="../../../static/website/css/bootstrap.min.css" rel="stylesheet" /> -->

    <!-- Template Stylesheet -->
    <link href="../../../static/website/css/style.css" rel="stylesheet" />

    <!-- Load fonts style after rendering the layout styles -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;200;300;400;500;700;900&display=swap"
    />
    <link rel="stylesheet" href="../../../static/website/css/fontawesome.min.css" />

    <!-- Slick -->
    <link rel="stylesheet" type="text/css" href="../../../static/website/css/slick.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../static/website/css/slick-theme.css" />
    <!--
    
TemplateMo 559 Zay Shop

https://templatemo.com/tm-559-zay-shop

-->

    <!-- ... (Các khai báo khác như trong mã HTML trước) ... -->
  </head>
  <body>
    <div class="container mt-5">
      <h1 class="text-center">Giỏ hàng</h1>
      <div>
        <div>
          <a href="product.html"
            ><h6 style="color: blue"><-Thêm Sản Phẩm khác</h6>
          </a>
        </div>
      </div>
      <!-- Bảng hiển thị sản phẩm trong giỏ hàng -->
      <form action="" method="get">
        <div class="card">
          <div class="card-body">
            <table class="table">
              <thead>
                <tr>
                  <th scope="col">Ảnh</th>
                  <th scope="col">Tên sản phẩm</th>
                  <th scope="col">Màu sắc</th>
                  <th scope="col">Số lượng</th>
                  <th scope="col">Giá</th>
                  <th scope="col">Thành tiền</th>
                  <th scope="col"></th>
                </tr>
              </thead>
              <tbody>
                <!-- Dòng sản phẩm trong giỏ hàng -->
                <tr>
                  <td>
                    <img
                      src="../../../static/website/img/giay-mlb-liner-mid-monogram-ny.jpeg"
                      alt="Sản phẩm 1"
                      style="max-width: 80px; max-height: 80px"
                    />
                  </td>
                  <td>Sản phẩm 1</td>
                  <td>Đỏ</td>
                  <td>
                    <input
                      type="number"
                      class="form-control quantity"
                      value="1"
                      min="0"
                    />
                  </td>
                  <td class="price">200,000</td>
                  <td class="subtotal">200,000</td>
                  <td>
                    <button type="button" class="btn btn-danger remove">
                      <i class="bi bi-trash"></i>
                    </button>
                  </td>
                </tr>
                <!-- Thêm các sản phẩm khác ở đây -->
                <!-- Dòng sản phẩm trong giỏ hàng -->
                <tr>
                  <td>
                    <img
                      src="../../../static/website/img/giay-nike-air-jordan-1-low-true-blue-cement-like-auth.jpg"
                      alt="Sản phẩm 1"
                      style="max-width: 80px; max-height: 80px"
                    />
                  </td>
                  <td>Sản phẩm 2</td>
                  <td>Xanh</td>
                  <td>
                    <input
                      type="number"
                      class="form-control quantity"
                      value="1"
                      min="0"
                    />
                  </td>
                  <td class="price">600,000</td>
                  <td class="subtotal">600,000</td>
                  <td>
                    <button type="button" class="btn btn-danger remove">
                      <i class="bi bi-trash"></i>
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
            <!-- Tổng số tiền -->
            <div class="text-end">
              <label for="" style="color: red">
                Tạm Tính : <span id="total">800,000</span>
              </label>
              <h6 id="emptyCartText" style="color: red; display: none">
                Giỏ hàng trống
              </h6>
            </div>
            <!-- Thông tin khách hàng -->
            <h4>Nhập Thông Tin</h4>
            <div class="mb-3">
              <label for="hoTen" class="form-label">Họ tên</label>
              <div id="error-hoTen" class="text-danger"></div>
              <input type="text" class="form-control" id="hoTen" name="hoTen" />
            </div>
            <div class="mb-3">
              <label for="diaChi" class="form-label">Địa chỉ</label>
              <div id="error-diaChi" class="text-danger"></div>
              <input
                type="text"
                class="form-control"
                id="diaChi"
                name="diaChi"
              />
            </div>
            <div class="mb-3">
              <label for="sdt" class="form-label">Số điện thoại</label>
              <div id="error-sdt" class="text-danger"></div>
              <input type="tel" class="form-control" id="sdt" name="sdt" />
            </div>
            <div class="mb-3">
              <label class="form-label">Phiếu giảm giá</label>
              <div id="error-phieuGiamGia" class="text-danger"></div>
              <select
                id="phieuGiamGia"
                class="form-select"
                aria-label="Default select example"
              >
                <option selected value="0">Không giảm giá</option>
                <option value="100000">Giảm 100,000 VND</option>
                <option value="200000">Giảm 200,000 VND</option>
              </select>
            </div>
            <!-- Thêm một phần tử radio button để chọn phương thức thanh toán -->
            <div class="mb-3">
              <label for="phuongThucThanhToan" class="form-label"
                >Phương thức thanh toán</label
              ><br />
              <input
                type="radio"
                id="thanhToanKhiNhanHang"
                name="phuongThucThanhToan"
                value="khiNhanHang"
                checked="checked"
              />
              <label for="thanhToanKhiNhanHang">Thanh toán khi nhận hàng</label
              ><br />
              <input
                type="radio"
                id="thanhToanBangZaloPay"
                name="phuongThucThanhToan"
                value="zaloPay"
              />
              <label for="thanhToanBangZaloPay">Thanh toán bằng ZaloPay</label>
            </div>
            <div class="mb-3">
              <label for="phiGiaoHangLabel" class="form-label"
                >Phí Giao Hàng</label
              >
              <label id="phiGiaoHangLabel" style="color: red">0đ</label>
            </div>
            <div class="mb-3">
              <label for="tongTienLabel" class="form-label">Tổng Tiền</label>
              <label id="tongTienLabel" style="color: red">800,000 VND</label>
            </div>
            <div class="d-grid gap-2 col-2 mx-auto">
              <button class="btn btn-primary" type="button">Đặt Hàng</button>
            </div>
          </div>
        </div>
      </form>
    </div>

    <!-- Liên kết với tệp JavaScript của Bootstrap (tuỳ chọn) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
    <!-- Liên kết với tệp bi-icons của Bootstrap (để sử dụng bi bi-trash) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.20.0/font/bootstrap-icons.css"></script>
    <!-- ... (các liên kết và mã HTML khác) ... -->

    <script>
      const quantityInputs = document.querySelectorAll(".quantity");
      const priceElements = document.querySelectorAll(".price");
      const subtotalElements = document.querySelectorAll(".subtotal");
      const totalElement = document.getElementById("total");
      const emptyCartText = document.getElementById("emptyCartText");
      const diaChiInput = document.getElementById("diaChi");
      const phiGiaoHangLabel = document.getElementById("phiGiaoHangLabel");
      const tongTienLabel = document.getElementById("tongTienLabel");
      const phieuGiamGiaSelect = document.getElementById("phieuGiamGia");
      let phiGiaoHangValue = 0;
      let phieuGiamGiaValue = 0;

      function formatToVND(amount) {
        return new Intl.NumberFormat("vi-VN", {
          style: "currency",
          currency: "VND",
        }).format(amount);
      }

      function updateTotal() {
        let total = 0;
        let hasProducts = false;
        for (let i = 0; i < quantityInputs.length; i++) {
          const quantity = parseInt(quantityInputs[i].value);
          const price = parseFloat(
            priceElements[i].textContent.replace("₫", "").replace(",", "")
          );
          const subtotal = quantity * price;
          subtotalElements[i].textContent = formatToVND(subtotal);
          total += subtotal;

          if (quantity > 0) {
            hasProducts = true;
          }
        }

        if (!hasProducts) {
          emptyCartText.style.display = "block";
          totalElement.textContent = formatToVND(0);
        } else {
          emptyCartText.style.display = "none";
          totalElement.textContent = formatToVND(total);
        }

        const tongTien = total - phieuGiamGiaValue + phiGiaoHangValue;
        tongTienLabel.textContent = formatToVND(tongTien);
      }

      quantityInputs.forEach((input) => {
        input.addEventListener("change", updateTotal);
      });

      const removeButtons = document.querySelectorAll(".remove");
      removeButtons.forEach((button) => {
        button.addEventListener("click", function () {
          const row = this.parentElement.parentElement;
          const quantityInput = row.querySelector(".quantity");
          quantityInput.value = 0;
          row.remove();
          updateTotal();
        });
      });

      const orderButton = document.querySelector("button.btn.btn-primary");
      orderButton.addEventListener("click", function () {
        const hoTen = document.getElementById("hoTen");
        const diaChi = document.getElementById("diaChi");
        const sdt = document.getElementById("sdt");
        const phuongThucThanhToan = document.querySelector('input[name="phuongThucThanhToan"]:checked');

        hoTen.style.borderColor = "";
        diaChi.style.borderColor = "";
        sdt.style.borderColor = "";

        if (hoTen.value.trim() === "") {
          hoTen.style.borderColor = "red";
          document.getElementById("error-hoTen").textContent = "Vui lòng nhập họ tên";
        } else {
          document.getElementById("error-hoTen").textContent = "";
        }

        if (diaChi.value.trim() === "") {
          diaChi.style.borderColor = "red";
          document.getElementById("error-diaChi").textContent = "Vui lòng nhập địa chỉ";
        } else {
          document.getElementById("error-diaChi").textContent = "";
        }

        if (sdt.value.trim() === "") {
          sdt.style.borderColor = "red";
          document.getElementById("error-sdt").textContent = "Vui lòng nhập số điện thoại";
        } else {
          document.getElementById("error-sdt").textContent = "";
        }

        if (hoTen.value.trim() !== "" && diaChi.value.trim() !== "" && sdt.value.trim() !== "") {
          if (phuongThucThanhToan.value === "khiNhanHang") {
            alert(`Xác nhận đặt hàng cho ${hoTen.value} tại địa chỉ ${diaChi.value} với số điện thoại ${sdt.value}. Phương thức thanh toán: Thanh toán khi nhận hàng.`);
          } else if (phuongThucThanhToan.value === "zaloPay") {
            alert(`Xác nhận đặt hàng cho ${hoTen.value} tại địa chỉ ${diaChi.value} với số điện thoại ${sdt.value}. Phương thức thanh toán: Thanh toán bằng ZaloPay.`);
          }
        }
      });
      phieuGiamGiaSelect.addEventListener("change", function () {
        phieuGiamGiaValue = parseFloat(phieuGiamGiaSelect.value);
        updateTotal();
      });

      diaChiInput.addEventListener("input", function () {
        const diaChi = diaChiInput.value.toLowerCase();
        phiGiaoHangValue = diaChi.includes("hà nội") ? 0 : 30000;
        phiGiaoHangLabel.textContent =
          phiGiaoHangValue === 0
            ? "Miễn phí giao hàng"
            : formatToVND(phiGiaoHangValue);
        updateTotal();
      });

      window.addEventListener("load", updateTotal);
    </script>
  </body>
</html>
